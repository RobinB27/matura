(mention in text what the hypothetical ExceptionDate and updatePortfolio functions do)

procedure main-loop (realtime):

    for every interval:
        if ExceptionDate(): break
        else:
            updatePortfolio()
        
        wait for interval length

procedure main-loop (historical data):

    date = StartingDate
    for every iteration:
        if ExceptionDate(): break
        else:
            updatePortfolio()
        
        date += 1